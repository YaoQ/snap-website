<blocks app="Snap! 4.0, http://snap.berkeley.edu" version="1"><block-definition s="digitalWrite: set %&apos;unitID&apos; as %&apos;command&apos;" type="command" category="hardware"><header></header><code></code><inputs><input type="%s"></input><input type="%txt">on</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>unitID</l><l>command</l></list><l>/*&#xD;* input parameters:&#xD;*   deviceID    : device unique ID&#xD;*   unitID      : identify different units on one device &#xD;*   ipAddress   : server IP address&#xD;*   port        : server port&#xD;*   path        : rest API routes path &#xD;*   command     : control the unit using the commands(W/R)&#xD;*   value       : return value &#xD;*/&#xD;//var fullUrl = window.url + window.path;&#xD;var fullUrl = url + path;&#xD;alert(fullUrl);&#xD;&#xD;var method = "POST";&#xD;var postData = new FormData();&#xD;&#xD;postData.append(&apos;unitID&apos;, unitID);&#xD;postData.append(&apos;command&apos;,command);&#xD;&#xD;alert(fullUrl);&#xD;&#xD;// You REALLY want async = true.&#xD;// Otherwise, it&apos;ll block ALL execution waiting for server response.&#xD;var async = true;&#xD;&#xD;var request = new XMLHttpRequest();&#xD;&#xD;request.onload = function () {&#xD;   // You can get all kinds of information about the HTTP response.&#xD;   var status = request.status; // HTTP response status, e.g., 200 for "200 OK"&#xD;   console.log(status);&#xD;}&#xD; &#xD;if( window.setFlag === undefined)&#xD; {&#xD;     alert("The first block of hardware script must set IPAddress block or others things.");&#xD; }&#xD;&#xD;request.open(method, fullUrl, async);&#xD;request.send(postData);&#xD;</l></block><list><block var="unitID"/><block var="command"/></list></block></script></block-definition><block-definition s="setDevice %&apos;deviceID&apos; %&apos;operation&apos;" type="command" category="hardware"><variables><list id="17"><item><l>deviceID</l></item><item><l>operation</l></item></list></variables><header></header><code></code><inputs><input type="%s"></input><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>deviceID</l><l>operation</l></list><l>/* &#xD;* input parameters: &#xD;*   deviceID    : device unique ID &#xD;*   unitID      : identify different units on one device  &#xD;*   ipAddress   : server IP address &#xD;*   port        : server port &#xD;*   path        : rest API routes path  &#xD;*   command     : control the unit using the commands(W/R) &#xD;*   value       : return value  &#xD;*/ &#xD;var path = &apos;/&apos; + deviceID + &apos;/&apos; + operation; &#xD;window.path = path;&#xD;</l></block><list><block var="deviceID"/><block var="operation"/></list></block></script></block-definition><block-definition s="setIPAddress : http:// %&apos;ipAddress&apos; : %&apos;port&apos;" type="command" category="hardware"><header></header><code></code><inputs><input type="%txt">192.168.1.1</input><input type="%n">4444</input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>ipAddress</l><l>port</l></list><l>/*&#xD;* input parameters:&#xD;*   deviceID    : device unique ID&#xD;*   unitID      : identify different units on one device &#xD;*   ipAddress   : server IP address&#xD;*   port        : server port&#xD;*   path        : rest API routes path &#xD;*   command     : control the unit using the commands(W/R)&#xD;*   value       : return value &#xD;*/&#xD;var url = "http://" + ipAddress + ":" + port;&#xD;&#xD;window.url = url;&#xD;&#xD;//Globle flag means IP address, path are set.&#xD;window.setFlag = true;&#xD;</l></block><list><block var="ipAddress"/><block var="port"/></list></block></script></block-definition><block-definition s="Signup : First_name %&apos;fn&apos; ; Last_name %&apos;ln&apos; Email: %&apos;email&apos; Password: %&apos;pass&apos;" type="command" category="hardware"><header></header><code></code><inputs><input type="%txt"></input><input type="%txt"></input><input type="%s"></input><input type="%s"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>fn</l><l>ln</l><l>email</l><l>pass</l></list><l>var url = &apos;http://127.0.0.1/serv&apos;&#xD;var signupUrl = url + &apos;/register/&apos;;&#xD;&#xD;var method = "POST";&#xD;var postData = new FormData();&#xD;&#xD;postData.append(&apos;fn&apos;,fn);&#xD;postData.append(&apos;ln&apos;, ln);&#xD;postData.append(&apos;email&apos;,email);&#xD;postData.append(&apos;pass&apos;,pass);&#xD;postData.append(&apos;userType&apos;,&apos;1&apos;);&#xD;postData.append(&apos;userGroup&apos;,&apos;0&apos;);&#xD;&#xD;// You REALLY want async = true.&#xD;// Otherwise, it&apos;ll block ALL execution waiting for server response.&#xD;var async = false;&#xD;&#xD;var request = new XMLHttpRequest();&#xD;&#xD;request.onload = function () {&#xD;   // You can get all kinds of information about the HTTP response.&#xD;   var status = request.status; // HTTP response status, e.g., 200 for "200 OK"&#xD;   console.log(status);&#xD;}&#xD;&#xD;request.open(method, signupUrl, async);&#xD;request.send(postData);&#xD;</l></block><list><block var="fn"/><block var="ln"/><block var="email"/><block var="pass"/></list></block></script></block-definition><block-definition s="login - Email: %&apos;email&apos; Password: %&apos;pass&apos;" type="command" category="hardware"><header></header><code></code><inputs><input type="%s"></input><input type="%txt"></input></inputs><script><block s="doRun"><block s="reportJSFunction"><list><l>email</l><l>pass</l></list><l>var url = &apos;http://127.0.0.1/serv&apos;&#xD;var signupUrl = url + &apos;/register/&apos;;&#xD;&#xD;var method = "POST";&#xD;var postData = new FormData();&#xD;&#xD;postData.append(&apos;email&apos;,email);&#xD;postData.append(&apos;pass&apos;,pass);&#xD;&#xD;// You REALLY want async = true.&#xD;// Otherwise, it&apos;ll block ALL execution waiting for server response.&#xD;var async = false;&#xD;&#xD;var request = new XMLHttpRequest();&#xD;var token;&#xD;&#xD;request.onload = function () {&#xD;   // You can get all kinds of information about the HTTP response.&#xD;   var status = request.status; // HTTP response status, e.g., 200 for "200 OK"&#xD;   var responseJson= JSON.parse(request.responseText);&#xD;   token=responseJson.token;&#xD;   alert(token);&#xD;   console.log(status);&#xD;}&#xD;&#xD;request.open(method, signupUrl, async);&#xD;request.send(postData);&#xD;&#xD;return token;&#xD;</l></block><list><block var="email"/><block var="pass"/></list></block></script></block-definition></blocks>